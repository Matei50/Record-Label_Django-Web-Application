{% extends "pgLang/baza.html"%}
{% block title %}
Artistii nostri
{% endblock %}

{% block content %}

<h1>Lista Artistilor</h1>

{% if warning_message %}
    <p style="color: orange; font-weight: bold;">{{ warning_message }}</p>
{% endif %}


<form method="GET" action="">
    <div class="filter-form">
        {% if form.non_field_errors %}
            <div class="form-error">{{ form.non_field_errors }}</div>
        {% endif %}
        {% for field in form %}
            <div class="form-group">
                {{ field.label_tag }}
                {{ field }}
                {% if field.errors %}<div class="form-error">{{ field.errors }}</div>{% endif %}
            </div>
        {% endfor %}
    </div>
    <button type="submit" class="button-primary">Filtreaza</button>    
    <a href="{% url 'lista-artisti' %}" 
       class="button-secondary" 
       onclick="return confirm('Sunteti sigur ca vreti sa resetati filtrele?');">
       Reseteaza
    </a>
</form>

<div class="sorting-links">
    Sorteaza dupa nume:
    {% with all_params=request.GET.urlencode %}
        {% if sort_display == 'A-Z' %}
            <strong>A-Z</strong>
        {% else %}
            <a href="?sort=a&{{ all_params|cut:'sort='|cut:'page=' }}">A-Z</a>
        {% endif %}
        |
        {% if sort_display == 'Z-A' %}
            <strong>Z-A</strong>
        {% else %}
            <a href="?sort=d&{{ all_params|cut:'sort='|cut:'page=' }}">Z-A</a>
        {% endif %}
    {% endwith %}
</div>


<ul class="artist-list"> 
    {% for artist in lista_artisti%}
        <li>
            <h3><a href="{% url 'detaliu-artist' artist.id %}">{{ artist.nume }}</a></h3>
            <p>{{ artist.bio|truncatewords:30 }}</p> 
            {% if artist.gen_muzical %}
                <div class="artist-genre">
                    Gen: <a href="{% url 'detaliu-gen' artist.gen_muzical.slug %}" class="genre-tag" style="background-color: {{ artist.gen_muzical.culoare }};">{{ artist.gen_muzical.nume }}</a>
                </div>
            {% endif %}
            {% if artist.imagine %}
                <img src="{{ artist.imagine.url }}" alt="{{ artist.nume }}" class="artist-list-img">
            {% endif %}
        </li> 
    {% empty %}
        <li>
            {% if request.GET %}                 Nu a fost gasit niciun artist care sa corespunda filtrelor.
            {% else %}
                Nu exista artisti in baza de date.
            {% endif %}
        </li>
    {% endfor %}
</ul>

<div class="pagination">
    <span class="step-links">
        {% with all_get_params=request.GET.urlencode %}
        <span class="current">
            Pagina {{ lista_artisti.number }} din {{ lista_artisti.paginator.num_pages }}.
        </span>
        {% if lista_artisti.has_previous %}
            <a href="?page=1&{{ all_get_params|cut:'page=' }}">&laquo; prima</a>
            <a href="?page={{ lista_artisti.previous_page_number }}&{{ all_get_params|cut:'page=' }}">inapoi</a>
        {% endif %}
        {% if lista_artisti.has_next %}
            <a href="?page={{ lista_artisti.next_page_number }}&{{ all_get_params|cut:'page=' }}">inainte</a>
            <a href="?page={{ lista_artisti.paginator.num_pages }}&{{ all_get_params|cut:'page=' }}">ultima &raquo;</a>
        {% endif %}
        {% endwith %}
    </span>
</div>
{%endblock %}